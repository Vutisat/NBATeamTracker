<!doctype html>
<html>
	<head>
		<title>NBA Team Tracker by Pob</title>
		<link rel="stylesheet" href="Styles/main.css">
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
		

		<SCRIPT LANGUAGE="JavaScript">

		<!-- Begin
		var state = ""
		function getTeam() {
			//httpReq.setRequestHeader('Access-Control-Allow-Headers', '*');
			var response
			var num = parseInt(document.getElementById("zip").value)

			//alert(num.length);
			//Error Checking
			if(isNaN(num)){
				alert("Please enter a numeric value.");
			}
			if(num.toString().length != 5){
				alert("A valid zipcode conatins 5 digits!");
			}

			getZipInfo(num);

			//Checking for correct answer
			document.getElementById("zip").value = num
			response = ""

				//This function calls an API to interpret the ZIP code for information
				function getZipInfo(input_zip){
								var zip_api = ("https://www.zipcodeapi.com/rest/js-U8EC3iiDDZSpUxdbJI02DXbm7h9ZmtngC1SGkbkXacn5JBgtjhvXfHjmYtmlWJBz/info.json/" + input_zip + "/degrees");
								//console.log(zip_api);
								$.ajax({
								    type: "GET",
								    crossDomain: true,
								    url: zip_api,
								    //They have padding so jsonp works
								    dataType: "json",
								    success: processData,
								    error: function(){ alert("Something went wrong, are you sure you entered a legitimate zipcode?");; }
								});

								function processData(data)
								{	
									//console.log(data);
									//var obj = JSON.parse(data);
									var obj = JSON.stringify(data);
									var obj2 = JSON.parse(obj);
				

									//Got the state info, now calling lambda
								    state = obj2.state
								    console.log(state);
								    callLambda(obj2);
								}
				}

				//Lambda Function finds the team by state
				function callLambda(state){
					//------------
						xhr = new XMLHttpRequest();
						var url = "https://uq3v5l2ll5.execute-api.us-east-1.amazonaws.com/prod/getLocalNBATeam";
						xhr.open("POST", url, true);
						xhr.setRequestHeader("Content-type", "application/json");
						xhr.onreadystatechange = function () { 
						    if (xhr.readyState == 4 && xhr.status == 200) {
						        var json = JSON.parse(xhr.responseText);
						        console.log(json)
						    }
						}
						var data = JSON.stringify({"key1":"CA"});
						xhr.send(data);
					//------------

					// var lambda_endpoint = ("https://uq3v5l2ll5.execute-api.us-east-1.amazonaws.com/prod/getLocalNBATeam");
					// 			console.log(lambda_endpoint);
					// 			$.ajax({
					// 			    type: "POST",
					// 			    crossDomain: true,
					// 			    url: lambda_endpoint,
					// 			    data: { key1:"CA"},
					// 			    dataType: "text",
					// 			    success: processData2,
					// 			    error: function(){ alert("Something went wrong while calling the lambda function");; }
					// });

					//Got the state from lambda, now going to display map and show team
					function processData2(data)
								{	
									console.log(data);
									//var obj = JSON.parse(data);
									//var obj = JSON.stringify(data);
									//var obj2 = JSON.parse(obj);

									//console.log(obj2);
									//TODO


					}

				}

			}
			// End -->
		</SCRIPT>
	</head>

	<body>
		
		<center>
			<img src="http://www.glaad.org/sites/default/files/styles/750px/public/images/2015-10/NBA%20logo%20banner.png?itok=1LGn4G3D" alt="" style="width:350px;">
		</center>
	
		<div class="Divisions">

			<ul>
				<div class="east_teams col-sm-12">
				<center><p style="font-size: 50px;"><strong>Enter a zipcode to find your state's favourite team or pick a team!</strong></p></center>

				<div class="input_zip">
				<center><p style="font-size: 40px;"><strong>Zip Code:</strong></p></center>
				</div>
				
				<div class="input_zip">
				<FORM onSubmit="getTeam(); return false">
					<INPUT TYPE="text" id="zip" NAME="zip" SIZE=5>
					<INPUT TYPE="button" class="btn btn-info" value="Go!" VALUE="     Submit   " onClick="getTeam();">
						</FORM>
						<FORM>
				</FORM>
				</div>

				<div class"local_team">
					<!-- result from API call to lambda to find state's team will go here -->
				</div>

				<center><p style="font-size: 50px; color:blue;"><strong>EASTERN CONFERENCE</strong></p></center>
					
						<ul style="list-style-type:none">
						<li><p class="divisions_names">Atlantic</p></li>
							<li>Boston Celtics</li>
							<li>Brooklyn Nets</li>
							<li>New York Knicks</li>
							<li>Philadelphia 76ers</li>
							<li>Toronto Raptors</li>
						<li><p class="divisions_names">Central</p></li>
							<a href="chi.html"><li>Chicago Bulls</li></a>
							<li>Cleveland Cavaliers</li>
							<li>Detroit Pistons</li>
							<li>Indiana Pacers</li>
							<li>Milwaukee Bucks</li>
						<li><p class="divisions_names">SouthEast</p></li>
							<li>Atlanta Hawks</li>
							<li>Charlote Hornets</li>
							<li>Miami Heat</li>
							<li>Orlando Magic</li>
							<li>Washington Wizards</li>
						</ul>
				</div>
				
				<div class="west_teams col-sm-12">
				<center><p style="font-size: 50px; color:red;"><strong>WESTERN CONFERENCE</strong></p></center>
					
						<ul style="list-style-type:none">
						<li><p class="divisions_names">Northwest</p></li>
							<li>Denver Nuggets</li>
							<li>Minnesota Timberwolves</li>
							<li>Oklahoma City Thunder</li>
							<li>Portland Trail Blazers</li>
							<li>Utah Jazz</li>
						<li><p class="divisions_names">Pacific</p></li>
							<li>Golden State Warriors</li>
							<li>Los Angeles Clippers</li>
							<li>Los Angeles Lakers</li>
							<li>Phoenix Suns</li>
							<li>Sacramento Kings</li>
						<li><p class="divisions_names">Southwest</p></li>
							<li>Dallas Mavericks</li>
							<li>Houston Rockets</li>
							<li>Memphis Grizzlies</li>
							<li>New Orleans Pelicans</li>
							<li>San Antonio Spurs</li>
						</ul>
				</div>
			</ul>
		</div>


		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<!-- Latest compiled and minified JavaScript -->
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	</body>
</html>